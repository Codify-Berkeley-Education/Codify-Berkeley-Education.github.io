<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-Assignments/database" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.2.1">
<title data-rh="true">6. Databases | 61D: Applied Software Development</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://codify-berkeley-education.github.io/img/brackets.svg"><meta data-rh="true" name="twitter:image" content="https://codify-berkeley-education.github.io/img/brackets.svg"><meta data-rh="true" property="og:url" content="https://codify-berkeley-education.github.io/docs/Assignments/database"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="6. Databases | 61D: Applied Software Development"><meta data-rh="true" name="description" content="Project Description - The Online Ordering System"><meta data-rh="true" property="og:description" content="Project Description - The Online Ordering System"><link data-rh="true" rel="icon" href="/img/brackets.svg"><link data-rh="true" rel="canonical" href="https://codify-berkeley-education.github.io/docs/Assignments/database"><link data-rh="true" rel="alternate" href="https://codify-berkeley-education.github.io/docs/Assignments/database" hreflang="en"><link data-rh="true" rel="alternate" href="https://codify-berkeley-education.github.io/docs/Assignments/database" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://NRGKLBJ96F-dsn.algolia.net" crossorigin="anonymous"><link rel="search" type="application/opensearchdescription+xml" title="61D: Applied Software Development" href="/opensearch.xml">
<link rel="preconnect" href="https://us.i.posthog.com">
<script>!function(t,e){var o,s,r,a;e.__SV||(window.posthog=e,e._i=[],e.init=function(i,n,p){function c(t,e){var o=e.split(".");2==o.length&&(t=t[o[0]],e=o[1]),t[e]=function(){t.push([e].concat(Array.prototype.slice.call(arguments,0)))}}(r=t.createElement("script")).type="text/javascript",r.async=!0,r.src=n.api_host.replace(".i.posthog.com","-assets.i.posthog.com")+"/static/array.js",(a=t.getElementsByTagName("script")[0]).parentNode.insertBefore(r,a);var g=e;for(void 0!==p?g=e[p]=[]:p="posthog",g.people=g.people||[],g.toString=function(t){var e="posthog";return"posthog"!==p&&(e+="."+p),t||(e+=" (stub)"),e},g.people.toString=function(){return g.toString(1)+".people (stub)"},o="capture identify alias people.set people.set_once set_config register register_once unregister opt_out_capturing has_opted_out_capturing opt_in_capturing reset isFeatureEnabled onFeatureFlags getFeatureFlag getFeatureFlagPayload reloadFeatureFlags group updateEarlyAccessFeatureEnrollment getEarlyAccessFeatures getActiveMatchingSurveys getSurveys onSessionId".split(" "),s=0;s<o.length;s++)c(g,o[s]);e._i.push([i,n,p])},e.__SV=1)}(document,window.posthog||[]),posthog.init("DEV",{api_host:"https://us.i.posthog.com",id:"default"})</script><link rel="stylesheet" href="/assets/css/styles.c5bf4533.css">
<script src="/assets/js/runtime~main.a9f103f6.js" defer="defer"></script>
<script src="/assets/js/main.d55660a6.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"dark")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/brackets.svg" alt="61D Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/brackets.svg" alt="61D Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">61D</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/setup">Content</a><a class="navbar__item navbar__link" href="/overview">Course Overview</a><a class="navbar__item navbar__link" href="/syllabus">Syllabus</a><a class="navbar__item navbar__link" href="/docs/glossary">Glossary</a></div><div class="navbar__items navbar__items--right"><a href="https://www.youtube.com/channel/UCn-nlwUrJYsQs1fvAdLXNnA" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">YouTube<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><a href="https://github.com/Codify-Berkeley-Education" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently dark mode)" aria-label="Switch between dark and light mode (currently dark mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search (Command+K)"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20" aria-hidden="true"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/setup">Course Setup</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/glossary">Glossary</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" href="/docs/Assignments/git-md-bash">Assignments</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Assignments/git-md-bash">0. Git, Markdown, and Bash</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Assignments/javascript">1. JavaScript</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Assignments/typescript">2. Typescript</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Assignments/react-todo">3. React</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Assignments/tailwind">4. Tailwind CSS</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Assignments/forms">5. Forms</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/Assignments/database">6. Databases</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Assignments/trpc">7. tRPC, React Query, and Next Auth</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Assignments/nextjs">8. Next.js</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Assignments/apis-and-webhooks">9. APIs and Webhooks</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Assignments/cloud">10. Cloud and Deployment</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Assignments/cd-cd-testing">11. CI/CD and Testing</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/Bonus/extensions">Bonus</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/Projects/proj-1-quickconvert">Projects</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/Readings/Fundamentals/0.1-git">Readings</a></div></li></ul></nav><button type="button" title="Collapse sidebar" aria-label="Collapse sidebar" class="button button--secondary button--outline collapseSidebarButton_PEFL"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_kv0_"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Assignments</span><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">6. Databases</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>6. Databases</h1>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="project-description---the-online-ordering-system">Project Description - The Online Ordering System<a href="#project-description---the-online-ordering-system" class="hash-link" aria-label="Direct link to Project Description - The Online Ordering System" title="Direct link to Project Description - The Online Ordering System">​</a></h2>
<p>Imagine you are developing the backend for a simpler version of an online ordering system like Snackpass for one specific restaurant. The system needs to handle different entities such as customers, orders, menu items, and some order details. This system will allow customers to register customer information, browse the menu, and place orders. It will also allow the restaurant owner to track each day&#x27;s total sales. How should we go about implementing the backend database system from scratch? We broke it down to 3 parts in this assignment. The first two parts can be completed after the first lecture. The last part can be completed after the second lecture.</p>
<ul>
<li>You will start by creating the schema given our context with specific requirements.</li>
<li>You will then learn to perform CRUD operations on the database by writing functions, validating the data, and doing migrations.</li>
<li>You will also get to try writing more complicated/advanced functions that mimic real-life operations.</li>
</ul>
<p>We will walk through the setup for the schema and some example questions in the lab together and we will leave the rest as homework.
In this assignment, we&#x27;d also like for you to practice reading through documentation and example code by yourself. We&#x27;ve provided links to the documentation of any relevant operations you will be working with in each section, and it should be pretty straightforward to find what you need. We will also give you some hints and guidance along the way. However, as you go on to work on your own projects in the future, you will often have to navigate through lengthy documentation by yourself. Now is the time to get some practice!</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="tech-stack">Tech Stack<a href="#tech-stack" class="hash-link" aria-label="Direct link to Tech Stack" title="Direct link to Tech Stack">​</a></h3>
<ul>
<li>Drizzle ORM + Drizzle Kit</li>
<li>SQLite</li>
<li>Zod</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="objectives">Objectives<a href="#objectives" class="hash-link" aria-label="Direct link to Objectives" title="Direct link to Objectives">​</a></h3>
<ul>
<li>Learn to set up a database schema using an ORM like Drizzle</li>
<li>Learn to write functions to interact with a database</li>
<li>Learn to validate data with Zod to ensure data integrity</li>
<li>Learn to perform database migrations to keep our database schema updated</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="setup">Setup<a href="#setup" class="hash-link" aria-label="Direct link to Setup" title="Direct link to Setup">​</a></h3>
<p>To get started, accept the assignment on Github Classroom and clone the repository to your folder locally.</p>
<p>Install the <a href="/docs/glossary#dependency">dependencies<span class="glossary-icon"> 📖</span></a> and create the database files:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#9CDCFE;--prism-background-color:#1E1E1E"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#9CDCFE"><span class="token plain">bun install</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">mkdir db</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">touch db/database.sqlite db/testdb.sqlite</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">bun db:push</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_BuS1"><p>If you are working on a project with a sqlite database, it is not good practice to commit the database file to GitHub.</p></div></div>
<p>When you are ready, run tests:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#9CDCFE;--prism-background-color:#1E1E1E"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#9CDCFE"><span class="token plain">bunx vitest src/tests/test_file_name.test.ts</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_BuS1"><p>You might see yourself failing a lot of tests when you run bun vitest for all test files. Don&#x27;t worry, this might be due to concurrency issues with the test files operating on the test database &quot;at the same time&quot;, leading to errors. We recommend you run bun vitest on specific test files to see if you&#x27;ve passed the tests. For example, if you&#x27;ve finished writing the CRUD functions for the customers table, you can run <code>bunx vitest src/tests/customerCRUD.test.ts</code>.</p></div></div>
<p>Feel free to test your code by adding functions in the src/index.ts file. To run:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#9CDCFE;--prism-background-color:#1E1E1E"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#9CDCFE"><span class="token plain">bun run src/index.ts</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>There are 3 folders you need to focus on:</p>
<ol>
<li>
<p><strong>Schemas</strong>:</p>
<ul>
<li><strong>File</strong>: <code>schemas/schema.ts</code></li>
<li><strong>Task</strong>: Define the schema in this file.</li>
</ul>
</li>
<li>
<p><strong>Functions</strong>:</p>
<ul>
<li><strong>Files</strong>: <code>functions/crud.ts</code> and <code>functions/advanced.ts</code></li>
<li><strong>Tasks</strong>:<!-- -->
<ul>
<li>Create your CRUD operations in <code>functions/crud.ts</code>.</li>
<li>Implement advanced operations in <code>functions/advanced.ts</code>.</li>
</ul>
</li>
</ul>
</li>
<li>
<p><strong>Tests</strong>:</p>
<ul>
<li><strong>Folder</strong>: <code>tests/</code></li>
<li><strong>Task</strong>: We have defined some tests to ensure your code works properly. Feel free to take a look at the tests to see what edge cases we test for.</li>
</ul>
</li>
</ol>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="part-1-schema-definitions">Part 1: Schema Definitions<a href="#part-1-schema-definitions" class="hash-link" aria-label="Direct link to Part 1: Schema Definitions" title="Direct link to Part 1: Schema Definitions">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="defining-tables">Defining Tables<a href="#defining-tables" class="hash-link" aria-label="Direct link to Defining Tables" title="Direct link to Defining Tables">​</a></h3>
<p>With the specific requirements for each table below, let&#x27;s first define the schema for our database in the <code>schemas/schema.ts</code> file. You might find the Drizzle documentation on <strong><a href="https://orm.drizzle.team/docs/column-types/sqlite" target="_blank" rel="nofollow">data types<span><span class="glossary-icon"> ↗</span></span></a></strong> and <strong><a href="https://orm.drizzle.team/docs/indexes-constraints" target="_blank" rel="nofollow">constraints<span><span class="glossary-icon"> ↗</span></span></a></strong> in SQLite helpful for your reference. Make sure to look at the documentation for SQLite, not MySQL or PostgreSQL!</p>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_BuS1"><p>When you define your sqlite tables, you will need to pass in a string as the sqlite name for each table and each field. To see what convention you should use to label your table&#x27;s field names, make sure to check out the <strong>beforeAll()</strong> call at the very top of any of the test files. This should give you some clues as to how to define your tables as well!
For example, in the <code>orders</code> table, the sqlite name of the field total amount should be labeled as <code>&#x27;total_amount&#x27;</code> and not <code>&#x27;totalAmount&#x27;</code> or any other form.
Locally, you can name the variable referring to this field whatever you like as long as you keep it consistent. For example, <code>totalAmount: real(&quot;total_amount&quot;).notNull()</code> is totally fine.
This is usually not necessary but, because we don&#x27;t have a test that checks for the correctness of your schema, we manually create a table in the tests and assume that your schema follows the same naming scheme and has the same fields and constraints.</p></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="customers-customerschema">Customers <code>customerSchema</code><a href="#customers-customerschema" class="hash-link" aria-label="Direct link to customers-customerschema" title="Direct link to customers-customerschema">​</a></h4>
<ul>
<li><code>id</code>: (integer) The primary key of the table that automatically increments.</li>
<li><code>name</code>: (string) The name of the customer. Must be a non-empty string.</li>
<li><code>email</code>: (string) The email address of the customer. Must be a non-empty string. Must be in the form of a valid email address.</li>
<li><code>phone</code>: (string) The phone number of the customer. Must be a non-empty string. Must be UNIQUE!</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="menu-items-menuitemschema">Menu Items <code>menuItemSchema</code><a href="#menu-items-menuitemschema" class="hash-link" aria-label="Direct link to menu-items-menuitemschema" title="Direct link to menu-items-menuitemschema">​</a></h4>
<ul>
<li><code>id</code>: (integer) The primary key of the table that automatically increments.</li>
<li><code>name</code>: (string) The name of the menu item. Must be a non-empty string. Must be UNIQUE!</li>
<li><code>price</code>: (real number) The price of the menu item. Must be a positive number.</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="orders-orderschema">Orders <code>orderSchema</code><a href="#orders-orderschema" class="hash-link" aria-label="Direct link to orders-orderschema" title="Direct link to orders-orderschema">​</a></h4>
<ul>
<li><code>id</code>: (integer) The primary key of the table that automatically increments.</li>
<li><code>customerId</code>: (integer) The ID of the customer who placed this order. This is a foreign key.</li>
<li><code>totalAmount</code>: (real number) The total amount of the order. Must be a positive number.</li>
<li><code>orderDate</code>: (string) The date of the order. Must be in the format <code>YYYY-MM-DD</code>.</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="order-items-orderitemschema">Order Items <code>orderItemSchema</code><a href="#order-items-orderitemschema" class="hash-link" aria-label="Direct link to order-items-orderitemschema" title="Direct link to order-items-orderitemschema">​</a></h4>
<ul>
<li><code>id</code>: (integer) The primary key of the table that automatically increments.</li>
<li><code>orderId</code>: (integer) The ID of the order. Must be a positive number. This is a foreign key.</li>
<li><code>menuItemId</code>: (integer) The ID of the menu item. Must be a positive number. This is a foreign key.</li>
<li><code>quantity</code>: (integer) The quantity of the menu item ordered. Must be a positive number.</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="defining-relationships">Defining Relationships<a href="#defining-relationships" class="hash-link" aria-label="Direct link to Defining Relationships" title="Direct link to Defining Relationships">​</a></h3>
<p>Now, don&#x27;t forget to define the relationships between the tables. You might find the Drizzle documentation on <strong><a href="https://orm.drizzle.team/docs/rqb#declaring-relations" target="_blank" rel="nofollow">Drizzle Queries<span><span class="glossary-icon"> ↗</span></span></a></strong> helpful. The diagram below might help you better understand the relationship we are working with. Specifically:</p>
<ul>
<li>One Customer can place multiple Orders, but each Order can only be placed by one Customer.</li>
<li>One Order can have multiple OrderItems, but each OrderItem is linked to one Order.</li>
<li>One OrderItem can only be matched to one MenuItem, but each MenuItem can be referenced by multiple OrderItems.</li>
</ul>
<p><img decoding="async" loading="lazy" alt="database-diagram" src="/assets/images/Database_Assignment_Schema-2db51014dbcf36466f35a0c9fd6aedd8.png" width="1612" height="688" class="img_ev3q"></p>
<div class="theme-admonition theme-admonition-tip admonition_xJq3 alert alert--success"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>tip</div><div class="admonitionContent_BuS1"><p>Can you find a hidden <strong>many-to-many relationship</strong> in our schema?</p><p>Yes, if you look carefully, each <code>Order</code> can contain multiple different <code>Menu Items</code> and each <code>Menu Item</code> can be in multiple different <code>Orders</code>! In Drizzle, how do we set up a many-to-many relationship as such? Typically, we set it up by creating a <strong>junction table</strong> (also known as a pivot table) to connect two other tables. In fact, you have already implemented it if you have not realized! In our schema, the <code>Order Items</code> table is technically a junction table that contains foreign IDs - <code>menuItemId</code> and <code>orderId</code> - that reference the <code>Orders</code> table and the <code>Menu Items</code> table.</p></div></div>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_BuS1"><p>After you write your schema or whenever you make an update to the schema, you should run a database migration with the following command. This will make sure your functions are working with the most update-to-date version of the schema.</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#9CDCFE;--prism-background-color:#1E1E1E"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#9CDCFE"><span class="token plain">bun drizzle-kit push</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>You will then see a new migration file appear in the migrations folder that documents any changes to the schema that you just pushed.</p><p>You might wonder why we are not running the actual drizzle-kit migrate command. Push lets us omit SQL files generation unlike migrate and it&#x27;s really good for rapid prototyping.</p></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="part-2-crud-functions">Part 2: CRUD Functions<a href="#part-2-crud-functions" class="hash-link" aria-label="Direct link to Part 2: CRUD Functions" title="Direct link to Part 2: CRUD Functions">​</a></h2>
<p>Using the schema defined in Part 1, let&#x27;s write some functions to perform simple CRUD (create, read, update, delete) operations and use Zod to validate the inputs for these functions to ensure data integrity. To save you some time, we have written zod validation for you, but please skim through it to make sure you understand the format for each field. A lot of these functions will look similar so once you&#x27;ve written the CRUD operations for one table, you will likely find it much faster to modify them for the rest of the tables.</p>
<p>You might find the documentation on <strong><a href="https://orm.drizzle.team/docs/select" target="_blank" rel="nofollow">select<span><span class="glossary-icon"> ↗</span></span></a>, <a href="https://orm.drizzle.team/docs/insert" target="_blank" rel="nofollow">insert<span><span class="glossary-icon"> ↗</span></span></a>, <a href="https://orm.drizzle.team/docs/update" target="_blank" rel="nofollow">update<span><span class="glossary-icon"> ↗</span></span></a>, <a href="https://orm.drizzle.team/docs/delete" target="_blank" rel="nofollow">delete<span><span class="glossary-icon"> ↗</span></span></a>,</strong> and <strong><a href="https://orm.drizzle.team/docs/operators" target="_blank" rel="nofollow">filter<span><span class="glossary-icon"> ↗</span></span></a></strong> helpful for your reference.</p>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_BuS1"><p>Normally, we wouldn&#x27;t need to pass in a separate <code>db</code> parameter into our functions since we will be interacting with a single database instance. However, we have to test your code with a separate clean database so we are passing in this parameter to distinguish between your own database to experiment with and the testing database. You should see that in your <code>db</code> folder you have <code>database.sqlite</code> and <code>testdb.sqlite</code>. You will be writing code to interact with the former.</p></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="customers">Customers<a href="#customers" class="hash-link" aria-label="Direct link to Customers" title="Direct link to Customers">​</a></h3>
<p>The online ordering system should be able to register new customers and update existing customers. Assume all customers use their phones to register an account and place orders. We will use the customers&#x27; phone numbers as their unique identifier.</p>
<ol>
<li>
<p><strong>Create a Customer</strong></p>
<ul>
<li><strong>Function</strong>: <code>createCustomer</code></li>
<li><strong>Parameters</strong>:<!-- -->
<ul>
<li><code>db</code>: Database instance.</li>
<li><code>data</code>: An object adhering to <code>customerSchema</code> (i.e. assume the input argument contains everything required for the customer schema).</li>
</ul>
</li>
<li><strong>Description</strong>: Inserts a new customer into the <code>customers</code> table.</li>
</ul>
</li>
<li>
<p><strong>Get a Customer by Phone</strong></p>
<ul>
<li><strong>Function</strong>: <code>getCustomerByPhone</code></li>
<li><strong>Parameters</strong>:<!-- -->
<ul>
<li><code>db</code>: Database instance.</li>
<li><code>phone</code>: A phone number that is unique to each customer</li>
</ul>
</li>
<li><strong>Description</strong>: Returns the customer who uses the given phone number (return the entire customer object).</li>
</ul>
</li>
<li>
<p><strong>Update a Customer by Phone</strong></p>
<ul>
<li><strong>Function</strong>: <code>updateCustomerByPhone</code></li>
<li><strong>Parameters</strong>:<!-- -->
<ul>
<li><code>db</code>: Database instance.</li>
<li><code>phone</code>: Customer&#x27;s phone number.</li>
<li><code>data</code>: An object with fields to update, adhering to <code>customerSchema</code>.</li>
</ul>
</li>
<li><strong>Description</strong>: Updates customer details based on their phone number.</li>
</ul>
</li>
<li>
<p><strong>Delete a Customer by Phone</strong></p>
<ul>
<li><strong>Function</strong>: <code>deleteCustomerByPhone</code></li>
<li><strong>Parameters</strong>:<!-- -->
<ul>
<li><code>db</code>: Database instance.</li>
<li><code>phone</code>: Customer&#x27;s phone number.</li>
</ul>
</li>
<li><strong>Description</strong>: Deletes a customer from the <code>customers</code> table by their phone number.</li>
</ul>
</li>
</ol>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="menu-items">Menu Items<a href="#menu-items" class="hash-link" aria-label="Direct link to Menu Items" title="Direct link to Menu Items">​</a></h3>
<p>Your online ordering system should be able to keep track of all items in a menu! You need to be able to add to and update the menu, and the customers need to be able to scan all of the items in the menu.</p>
<ol>
<li>
<p><strong>Create a Menu Item</strong></p>
<ul>
<li><strong>Function</strong>: <code>createMenuItem</code></li>
<li><strong>Parameters</strong>:<!-- -->
<ul>
<li><code>db</code>: Database instance.</li>
<li><code>data</code>: An object adhering to <code>menuItemSchema</code>.</li>
</ul>
</li>
<li><strong>Description</strong>: Inserts a new menu item into the <code>menuItems</code> table.</li>
</ul>
</li>
<li>
<p><strong>Get a Menu Item by ID</strong></p>
<ul>
<li><strong>Function</strong>: <code>getMenuItemById</code></li>
<li><strong>Parameters</strong>:<!-- -->
<ul>
<li><code>db</code>: Database instance.</li>
<li><code>id</code>: id of the menu item.</li>
</ul>
</li>
<li><strong>Description</strong>: Retrieves a menu item by its id from the <code>menuItems</code> table.</li>
</ul>
</li>
<li>
<p><strong>Update a Menu Item by ID</strong></p>
<ul>
<li><strong>Function</strong>: <code>updateMenuItemById</code></li>
<li><strong>Parameters</strong>:<!-- -->
<ul>
<li><code>db</code>: Database instance.</li>
<li><code>id</code>: the id of the menu item.</li>
<li><code>data</code>: An object with fields to update, adhering to <code>menuItemSchema</code>.</li>
</ul>
</li>
<li><strong>Description</strong>: Updates menu item details based on its id.</li>
</ul>
</li>
<li>
<p><strong>Delete a Menu Item by ID</strong></p>
<ul>
<li><strong>Function</strong>: <code>deleteMenuItemById</code></li>
<li><strong>Parameters</strong>:<!-- -->
<ul>
<li><code>db</code>: Database instance.</li>
<li><code>id</code>: id of the menu item.</li>
</ul>
</li>
<li><strong>Description</strong>: Deletes a menu item from the <code>menuItems</code> table.</li>
</ul>
</li>
</ol>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="orders">Orders<a href="#orders" class="hash-link" aria-label="Direct link to Orders" title="Direct link to Orders">​</a></h3>
<p>Your customers are placing order using this system! You need to keep track of who ordered it, how much the meal costs in total, and the time when the order is placed.</p>
<ol>
<li>
<p><strong>Create an Order</strong></p>
<ul>
<li><strong>Function</strong>: <code>createOrder</code></li>
<li><strong>Parameters</strong>:<!-- -->
<ul>
<li><code>db</code>: Database instance.</li>
<li><code>data</code>: An object adhering to <code>orderSchema</code>.</li>
</ul>
</li>
<li><strong>Description</strong>: Inserts a new order into the <code>orders</code> table.</li>
</ul>
</li>
<li>
<p><strong>Get All Orders</strong></p>
<ul>
<li><strong>Function</strong>: <code>getOrders</code></li>
<li><strong>Parameters</strong>:<!-- -->
<ul>
<li><code>db</code>: Database instance.</li>
</ul>
</li>
<li><strong>Description</strong>: Retrieves all orders from the <code>orders</code> table.</li>
</ul>
</li>
<li>
<p><strong>Get an Order by ID</strong></p>
<ul>
<li><strong>Function</strong>: <code>getOrderById</code></li>
<li><strong>Parameters</strong>:<!-- -->
<ul>
<li><code>db</code>: Database instance.</li>
<li><code>id</code>: ID of the order.</li>
</ul>
</li>
<li><strong>Description</strong>: Retrieves an order by its ID from the <code>orders</code> table.</li>
</ul>
</li>
<li>
<p><strong>Update an Order</strong></p>
<ul>
<li><strong>Function</strong>: <code>updateOrder</code></li>
<li><strong>Parameters</strong>:<!-- -->
<ul>
<li><code>db</code>: Database instance.</li>
<li><code>id</code>: ID of the order.</li>
<li><code>data</code>: An object with fields to update, adhering to <code>orderSchema</code>.</li>
</ul>
</li>
<li><strong>Description</strong>: Updates order details based on its ID.</li>
</ul>
</li>
<li>
<p><strong>Delete an Order</strong></p>
<ul>
<li><strong>Function</strong>: <code>deleteOrder</code></li>
<li><strong>Parameters</strong>:<!-- -->
<ul>
<li><code>db</code>: Database instance.</li>
<li><code>id</code>: ID of the order.</li>
</ul>
</li>
<li><strong>Description</strong>: Deletes an order from the <code>orders</code> table.</li>
</ul>
</li>
</ol>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="order-items">Order Items<a href="#order-items" class="hash-link" aria-label="Direct link to Order Items" title="Direct link to Order Items">​</a></h3>
<p>When you place an order, you also need to note down which specific items are ordered and how many are ordered. A customer might also add to an existing order or decides to order more of the same item.</p>
<ol>
<li>
<p><strong>Create an Order Item</strong></p>
<ul>
<li><strong>Function</strong>: <code>createOrderItem</code></li>
<li><strong>Parameters</strong>:<!-- -->
<ul>
<li><code>db</code>: Database instance.</li>
<li><code>data</code>: An object adhering to <code>orderItemSchema</code>.</li>
</ul>
</li>
<li><strong>Description</strong>: Inserts a new order item into the <code>orderItems</code> table.</li>
</ul>
</li>
<li>
<p><strong>Get Order Items by Order ID</strong></p>
<ul>
<li><strong>Function</strong>: <code>getOrderItemsByOrderId</code></li>
<li><strong>Parameters</strong>:<!-- -->
<ul>
<li><code>db</code>: Database instance.</li>
<li><code>orderId</code>: ID of the order. <strong>Note: this is not the orderItemID!</strong></li>
</ul>
</li>
<li><strong>Description</strong>: Retrieves all order items for a specific order.</li>
</ul>
</li>
<li>
<p><strong>Update an Order Item</strong></p>
<ul>
<li><strong>Function</strong>: <code>updateOrderItem</code></li>
<li><strong>Parameters</strong>:<!-- -->
<ul>
<li><code>db</code>: Database instance.</li>
<li><code>orderId</code>: ID of the order.</li>
<li><code>menuItemId</code>: ID of the menu item.</li>
<li><code>data</code>: An object with fields to update, adhering to <code>orderItemSchema</code>.</li>
</ul>
</li>
<li><strong>Description</strong>: Updates order item details based on order ID and menu item ID.</li>
</ul>
</li>
<li>
<p><strong>Delete Order Items by Order ID</strong></p>
<ul>
<li><strong>Function</strong>: <code>deleteOrderItemsbyOrderId</code></li>
<li><strong>Parameters</strong>:<!-- -->
<ul>
<li><code>db</code>: Database instance.</li>
<li><code>orderId</code>: ID of the order.</li>
</ul>
</li>
<li><strong>Description</strong>: Deletes all order items for a specific order (in the case the customer waits eternally for their meal and decides to angrily walk out of the restaurant).</li>
</ul>
</li>
</ol>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="part-3-advanced-functions">Part 3: Advanced functions<a href="#part-3-advanced-functions" class="hash-link" aria-label="Direct link to Part 3: Advanced functions" title="Direct link to Part 3: Advanced functions">​</a></h2>
<div class="theme-admonition theme-admonition-warning admonition_xJq3 alert alert--warning"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>warning</div><div class="admonitionContent_BuS1"><p>Only start this section when you&#x27;ve passed all the tests for the previous parts of the assignment.</p></div></div>
<p>Now that you&#x27;ve familiarized yourself with the basic operations we can do on a single table, let&#x27;s spice things up a little bit! In the following questions, you need to examine closely the relationship between two or more tables, and perform more complicated operations in one function. You might find the Drizzle Documentation helpful for your reference.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="question-1-place-an-order">Question 1: Place an Order<a href="#question-1-place-an-order" class="hash-link" aria-label="Direct link to Question 1: Place an Order" title="Direct link to Question 1: Place an Order">​</a></h3>
<ul>
<li>
<p><strong>Function</strong>: <code>placeOrder</code></p>
</li>
<li>
<p><strong>Description</strong>: Places an order for a customer. This function needs to do the following operations in order.</p>
<ul>
<li>Check to see if the customer is already in the customers table. If not, create a new customer (call <code>createCustomer</code> from part 2).</li>
<li>Calculate the total cost of the order.</li>
<li>Create the order (call <code>createOrder</code> from part 2).</li>
<li>Insert relevant order items (call <code>createOrderItem</code> from part 2).</li>
</ul>
<p>We will pack all of the operations in a <strong><a href="https://orm.drizzle.team/docs/transactions" target="_blank" rel="nofollow">database transaction<span><span class="glossary-icon"> ↗</span></span></a></strong> to ensure consistency. By packing operations into a transaction, we make an attempt to work through a series of actions in an &quot;all or nothing&quot; manner. This means that the transaction will succeed only if all sub-operations succeed. If we fail at any point in a transaction, all actions will be revoked so we don&#x27;t leave the database in an inconsistent state.</p>
</li>
</ul>
<div class="theme-admonition theme-admonition-tip admonition_xJq3 alert alert--success"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>tip</div><div class="admonitionContent_BuS1"><p>You might need to get the index of the last object you created and use it in the next operation. Here&#x27;s how you can do it. Since our primary keys are generated on auto-increment, we can use <code>lastInsertRowid</code>. And since this row id has type number | bigint, we need to convert it to a number with <code>Number()</code>.</p><div class="language-typescript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#9CDCFE;--prism-background-color:#1E1E1E"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-typescript codeBlock_bY9V thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#9CDCFE"><span class="token plain">customerId </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(220, 220, 170)">Number</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">newCustomer</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">lastInsertRowid</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(106, 153, 85)">// Get the ID of the newly created customer</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div>
<ul>
<li><strong>Parameters</strong>:<!-- -->
<ul>
<li><code>db</code>: Database instance.</li>
<li><code>data</code>: An object adhering to <code>placeOrderSchema</code>, which includes:<!-- -->
<ul>
<li><code>customer</code>: The customer&#x27;s basic information<!-- -->
<ul>
<li><code>name</code>: The name of the customer placing the order.</li>
<li><code>email</code>: The customer&#x27;s email.</li>
<li><code>phone</code>: The customer&#x27;s phone number.</li>
</ul>
</li>
<li><code>items</code>: An array of items to be included in the order. Each item includes:<!-- -->
<ul>
<li><code>menuItemId</code>: The ID of the menu item.</li>
<li><code>quantity</code>: The quantity of the menu item ordered.</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><strong>Returns</strong>: An object containing:<!-- -->
<ul>
<li><code>success</code>: A boolean indicating whether the order was placed successfully.</li>
<li><code>orderId</code>: The ID of the newly created order.</li>
</ul>
</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="question-2-retrieve-orders-for-a-specific-day-and-calculate-total-sales">Question 2: Retrieve Orders for a Specific Day and Calculate Total Sales<a href="#question-2-retrieve-orders-for-a-specific-day-and-calculate-total-sales" class="hash-link" aria-label="Direct link to Question 2: Retrieve Orders for a Specific Day and Calculate Total Sales" title="Direct link to Question 2: Retrieve Orders for a Specific Day and Calculate Total Sales">​</a></h3>
<ul>
<li>
<p><strong>Function</strong>: <code>totalSale</code></p>
</li>
<li>
<p><strong>Description</strong>: The restaurant needs to track its daily sales to monitor its financial performance. This function will aggregate the total sales (sum of all orders) for a given date. The function should compute the total sales for all orders placed on that day. The function needs to perform the following steps:</p>
<ul>
<li>Accept a specific date as input (format: YYYY-MM-DD).</li>
<li>Retrieve all orders placed on that date.</li>
<li>Sum the total amounts of all orders for that day.</li>
</ul>
</li>
<li>
<p><strong>Parameters</strong>:</p>
<ul>
<li><code>db</code>: Database instance.</li>
<li><code>data</code>: An object adhering to <code>getOrdersForDaySchema</code>, which includes:<!-- -->
<ul>
<li><code>date</code>: The date for which orders are to be retrieved (in <code>YYYY-MM-DD</code> format).</li>
</ul>
</li>
</ul>
</li>
<li>
<p><strong>Returns</strong>: An object containing:</p>
<ul>
<li><code>totalSales</code>: The total sales amount for the specified date.</li>
</ul>
</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="bonus-question-3--order-optimizer-menu-suggestions-based-on-order-history">(BONUS) Question 3 : Order Optimizer: Menu Suggestions Based on Order History<a href="#bonus-question-3--order-optimizer-menu-suggestions-based-on-order-history" class="hash-link" aria-label="Direct link to (BONUS) Question 3 : Order Optimizer: Menu Suggestions Based on Order History" title="Direct link to (BONUS) Question 3 : Order Optimizer: Menu Suggestions Based on Order History">​</a></h3>
<ul>
<li>
<p><strong>Function</strong>: <code>suggestMenuItemsForCustomer</code></p>
</li>
<li>
<p><strong>Description</strong>:
The restaurant wants to provide personalized menu item recommendations to customers based on their past orders. The function will analyze a customer&#x27;s order history and suggest the top 3 most frequently ordered items as the customer&#x27;s all time favorite. The function needs to perform the following steps:</p>
<ul>
<li>Fetch the customer’s order history using their phone number.</li>
<li>Identify the most frequently ordered menu items in their order history.</li>
<li>Return the top 3 most frequently ordered items from the customer’s older history.</li>
</ul>
</li>
</ul>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary><strong>HINT 1</strong>: Why might JOIN make your life easier?</summary><div><div class="collapsibleContent_i85q"><p>You might find the documentation on <strong><a href="https://orm.drizzle.team/docs/joins" target="_blank" rel="nofollow">join operations<span><span class="glossary-icon"> ↗</span></span></a></strong> helpful. When you&#x27;re working with multiple related tables, like <code>Orders</code>, <code>Order Items</code>, and <code>Menu Items</code>, using join operations can be crucial for simplifying your queries and improving performance. Let’s break down why:</p><ul>
<li>You need to retrieve a customer’s order history along with the specific items they ordered. If you were to query each table separately (e.g., fetching orders, then fetching orderItems, then fetching menuItems), you would make multiple queries to the database. This would be inefficient and harder to manage. With a join, you can retrieve all the related data in one query.</li>
<li>A join operation allows you to bring together the necessary data from multiple tables (like orders, orderItems, and menuItems) in a single result. This is especially useful when you want to count how frequently a customer ordered each menu item.</li>
</ul></div></div></details>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary> <strong>HINT 2</strong>: How specifically can we implement JOIN?</summary><div><div class="collapsibleContent_i85q"><p>You can get all the menu items a customer has ordered in the past. By joining the <code>Order Items</code> table with the <code>Order</code> table (on <code>orderId</code>) and then with the <code>Menu Items</code> table (on <code>menuItemId</code>), you can directly retrieve the items without multiple queries.</p></div></div></details>
<ul>
<li>
<p><strong>Parameters</strong>:</p>
</li>
<li>
<p><code>db</code>: Database instance.</p>
</li>
<li>
<p><code>phone</code>: The customer’s phone number (used to retrieve their order history).</p>
</li>
<li>
<p><strong>Returns</strong>:
An array of up to 3 menu item objects (menuItemSchema) representing the recommended items.</p>
</li>
</ul></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"><a href="https://github.com/CS61D/website/tree/main/docs/Assignments/database.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/Assignments/forms"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">5. Forms</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/Assignments/trpc"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">7. tRPC, React Query, and Next Auth</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#project-description---the-online-ordering-system" class="table-of-contents__link toc-highlight">Project Description - The Online Ordering System</a><ul><li><a href="#tech-stack" class="table-of-contents__link toc-highlight">Tech Stack</a></li><li><a href="#objectives" class="table-of-contents__link toc-highlight">Objectives</a></li><li><a href="#setup" class="table-of-contents__link toc-highlight">Setup</a></li></ul></li><li><a href="#part-1-schema-definitions" class="table-of-contents__link toc-highlight">Part 1: Schema Definitions</a><ul><li><a href="#defining-tables" class="table-of-contents__link toc-highlight">Defining Tables</a></li><li><a href="#defining-relationships" class="table-of-contents__link toc-highlight">Defining Relationships</a></li></ul></li><li><a href="#part-2-crud-functions" class="table-of-contents__link toc-highlight">Part 2: CRUD Functions</a><ul><li><a href="#customers" class="table-of-contents__link toc-highlight">Customers</a></li><li><a href="#menu-items" class="table-of-contents__link toc-highlight">Menu Items</a></li><li><a href="#orders" class="table-of-contents__link toc-highlight">Orders</a></li><li><a href="#order-items" class="table-of-contents__link toc-highlight">Order Items</a></li></ul></li><li><a href="#part-3-advanced-functions" class="table-of-contents__link toc-highlight">Part 3: Advanced functions</a><ul><li><a href="#question-1-place-an-order" class="table-of-contents__link toc-highlight">Question 1: Place an Order</a></li><li><a href="#question-2-retrieve-orders-for-a-specific-day-and-calculate-total-sales" class="table-of-contents__link toc-highlight">Question 2: Retrieve Orders for a Specific Day and Calculate Total Sales</a></li><li><a href="#bonus-question-3--order-optimizer-menu-suggestions-based-on-order-history" class="table-of-contents__link toc-highlight">(BONUS) Question 3 : Order Optimizer: Menu Suggestions Based on Order History</a></li></ul></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/overview">Overview</a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Build with Docusaurus</div></div></div></footer></div>
</body>
</html>