"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[3212],{7731:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>i,contentTitle:()=>o,default:()=>d,frontMatter:()=>s,metadata:()=>l,toc:()=>c});var a=n(4848),r=n(8453);n(1470),n(9365);const s={sidebar_position:4},o="Rapid Full Stack Form Prototyping with T3",l={id:"Bonus/fullstack-forms",title:"Rapid Full Stack Form Prototyping with T3",description:"- View example",source:"@site/docs/Bonus/fullstack-forms.md",sourceDirName:"Bonus",slug:"/Bonus/fullstack-forms",permalink:"/docs/Bonus/fullstack-forms",draft:!1,unlisted:!1,editUrl:"https://github.com/CS61D/website/tree/main/docs/Bonus/fullstack-forms.md",tags:[],version:"current",sidebarPosition:4,frontMatter:{sidebar_position:4},sidebar:"tutorialSidebar",previous:{title:"Setting up Postgres for Local Development",permalink:"/docs/Bonus/running-postgres-with-docker"},next:{title:"Using Vitest",permalink:"/docs/Bonus/vitest-guide"}},i={},c=[{value:"Setup",id:"setup",level:2}];function u(e){const t={a:"a",code:"code",h1:"h1",h2:"h2",li:"li",p:"p",pre:"pre",span:"span",ul:"ul",...(0,r.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(t.h1,{id:"rapid-full-stack-form-prototyping-with-t3",children:"Rapid Full Stack Form Prototyping with T3"}),"\n",(0,a.jsxs)(t.ul,{children:["\n",(0,a.jsx)(t.li,{children:(0,a.jsxs)(t.a,{href:"https://fullstackforms.aidansunbury.dev/",rel:"nofollow",children:["View example",(0,a.jsx)(t.span,{children:(0,a.jsx)(t.span,{className:"glossary-icon",children:" \u2197"})})]})}),"\n"]}),"\n",(0,a.jsx)(t.p,{children:"The beauty of the T3 stack is that the frontend and backend of an application can be so tightly integrated. A database schema defined with Drizzle can automatically be used to generate zod validators, which can be allows for use of the same validation on the frontend and the backend. Moreover, zod integrates flawlessly with react-hook-form, which in turn integrates beautifully with shadcn."}),"\n",(0,a.jsx)(t.p,{children:"The one downside is that creating these forms over and over again often requires a lot of boilerplate code, especially when adding ui/ux enhancements such as loading indicators and success messages. This page walks through setting up a simple full stack form, and gives you convenient copy and paste code snippets for setting up the imports, form state, and actual form components."}),"\n",(0,a.jsx)(t.h2,{id:"setup",children:"Setup"}),"\n",(0,a.jsx)(t.p,{children:"First, make sure you have the needed dependencies installed:"}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-bash",children:"bun add drizzle-zod react-beforeunload\n"})}),"\n",(0,a.jsx)(t.p,{children:"And the required shadcn components:"}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-bash",children:"bunx --bun shadcn@latest add dialog button input form select command badge\n"})}),"\n",(0,a.jsxs)(t.p,{children:["Also add the ",(0,a.jsxs)(t.a,{href:"https://shadcnui-expansions.typeart.cc/docs/multiple-selector",rel:"nofollow",children:["multiple-selector",(0,a.jsx)(t.span,{children:(0,a.jsx)(t.span,{className:"glossary-icon",children:" \u2197"})})]})," and ",(0,a.jsxs)(t.a,{href:"https://shadcnui-expansions.typeart.cc/docs/loading-button",rel:"nofollow",children:["loading button",(0,a.jsx)(t.span,{children:(0,a.jsx)(t.span,{className:"glossary-icon",children:" \u2197"})})]})," expansion component. I just replaced my existing button component, seeing as all of the functionality is the same except for the optional loading state."]}),"\n",(0,a.jsxs)(t.p,{children:["Finally, make a wrapper component for the ",(0,a.jsx)(t.code,{children:"drizzle-zod"})," createInsertSchema function which omits any fields that should only be created by the database. This will make your forms and tRPC procedures safer. You may want to modify this function to suit your needs."]}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-ts",metastring:"src/lib/safeInsertSchema.ts",children:'import type { Table } from "drizzle-orm";\nimport { createInsertSchema } from "drizzle-zod";\n\n// Ensures the id and createdAt columns are automatically set by the database, but all other values may be passed in.\nexport function safeInsertSchema<TTable extends Table>(table: TTable) {\n  return createInsertSchema(table).omit({\n    id: true,\n    createdAt: true,\n  });\n}\n'})}),"\n",(0,a.jsxs)(t.p,{children:["You may optionally modify your shadcn ",(0,a.jsx)(t.code,{children:"FormLabel"})," component to be able to display a nice asterisk for required fields."]}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-tsx",metastring:"src/components/form.tsx",children:'interface FormLabelProps\n  extends React.ComponentPropsWithoutRef<typeof LabelPrimitive.Root> {\n  optional?: boolean;\n}\n\nconst FormLabel = React.forwardRef<\n  React.ElementRef<typeof LabelPrimitive.Root>,\n  FormLabelProps\n>(({ className, optional = true, children, ...props }, ref) => {\n  const { error, formItemId } = useFormField();\n\n  return (\n    <Label\n      ref={ref}\n      className={cn(error && "text-destructive", className)}\n      htmlFor={formItemId}\n      {...props}\n    >\n      {children}\n      {!optional && <span className="text-destructive ml-1">*</span>}\n    </Label>\n  );\n});\nFormLabel.displayName = "FormLabel";\n'})}),"\n",(0,a.jsxs)(t.p,{children:["Now you are ready to copy and paste forms from ",(0,a.jsxs)(t.a,{href:"https://fullstackforms.aidansunbury.dev/",rel:"nofollow",children:["fullstackforms.aidansunbury.dev",(0,a.jsx)(t.span,{children:(0,a.jsx)(t.span,{className:"glossary-icon",children:" \u2197"})})]}),"."]})]})}function d(e={}){const{wrapper:t}={...(0,r.R)(),...e.components};return t?(0,a.jsx)(t,{...e,children:(0,a.jsx)(u,{...e})}):u(e)}},9365:(e,t,n)=>{n.d(t,{A:()=>o});n(6540);var a=n(4164);const r={tabItem:"tabItem_Ymn6"};var s=n(4848);function o(e){let{children:t,hidden:n,className:o}=e;return(0,s.jsx)("div",{role:"tabpanel",className:(0,a.A)(r.tabItem,o),hidden:n,children:t})}},1470:(e,t,n)=>{n.d(t,{A:()=>j});var a=n(6540),r=n(4164),s=n(3104),o=n(6347),l=n(205),i=n(7485),c=n(1682),u=n(9466);function d(e){return a.Children.toArray(e).filter((e=>"\n"!==e)).map((e=>{if(!e||(0,a.isValidElement)(e)&&function(e){const{props:t}=e;return!!t&&"object"==typeof t&&"value"in t}(e))return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)}))?.filter(Boolean)??[]}function p(e){const{values:t,children:n}=e;return(0,a.useMemo)((()=>{const e=t??function(e){return d(e).map((e=>{let{props:{value:t,label:n,attributes:a,default:r}}=e;return{value:t,label:n,attributes:a,default:r}}))}(n);return function(e){const t=(0,c.X)(e,((e,t)=>e.value===t.value));if(t.length>0)throw new Error(`Docusaurus error: Duplicate values "${t.map((e=>e.value)).join(", ")}" found in <Tabs>. Every value needs to be unique.`)}(e),e}),[t,n])}function h(e){let{value:t,tabValues:n}=e;return n.some((e=>e.value===t))}function m(e){let{queryString:t=!1,groupId:n}=e;const r=(0,o.W6)(),s=function(e){let{queryString:t=!1,groupId:n}=e;if("string"==typeof t)return t;if(!1===t)return null;if(!0===t&&!n)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return n??null}({queryString:t,groupId:n});return[(0,i.aZ)(s),(0,a.useCallback)((e=>{if(!s)return;const t=new URLSearchParams(r.location.search);t.set(s,e),r.replace({...r.location,search:t.toString()})}),[s,r])]}function f(e){const{defaultValue:t,queryString:n=!1,groupId:r}=e,s=p(e),[o,i]=(0,a.useState)((()=>function(e){let{defaultValue:t,tabValues:n}=e;if(0===n.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(t){if(!h({value:t,tabValues:n}))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${t}" but none of its children has the corresponding value. Available values are: ${n.map((e=>e.value)).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);return t}const a=n.find((e=>e.default))??n[0];if(!a)throw new Error("Unexpected error: 0 tabValues");return a.value}({defaultValue:t,tabValues:s}))),[c,d]=m({queryString:n,groupId:r}),[f,b]=function(e){let{groupId:t}=e;const n=function(e){return e?`docusaurus.tab.${e}`:null}(t),[r,s]=(0,u.Dv)(n);return[r,(0,a.useCallback)((e=>{n&&s.set(e)}),[n,s])]}({groupId:r}),g=(()=>{const e=c??f;return h({value:e,tabValues:s})?e:null})();(0,l.A)((()=>{g&&i(g)}),[g]);return{selectedValue:o,selectValue:(0,a.useCallback)((e=>{if(!h({value:e,tabValues:s}))throw new Error(`Can't select invalid tab value=${e}`);i(e),d(e),b(e)}),[d,b,s]),tabValues:s}}var b=n(2303);const g={tabList:"tabList__CuJ",tabItem:"tabItem_LNqP"};var x=n(4848);function y(e){let{className:t,block:n,selectedValue:a,selectValue:o,tabValues:l}=e;const i=[],{blockElementScrollPositionUntilNextRender:c}=(0,s.a_)(),u=e=>{const t=e.currentTarget,n=i.indexOf(t),r=l[n].value;r!==a&&(c(t),o(r))},d=e=>{let t=null;switch(e.key){case"Enter":u(e);break;case"ArrowRight":{const n=i.indexOf(e.currentTarget)+1;t=i[n]??i[0];break}case"ArrowLeft":{const n=i.indexOf(e.currentTarget)-1;t=i[n]??i[i.length-1];break}}t?.focus()};return(0,x.jsx)("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,r.A)("tabs",{"tabs--block":n},t),children:l.map((e=>{let{value:t,label:n,attributes:s}=e;return(0,x.jsx)("li",{role:"tab",tabIndex:a===t?0:-1,"aria-selected":a===t,ref:e=>i.push(e),onKeyDown:d,onClick:u,...s,className:(0,r.A)("tabs__item",g.tabItem,s?.className,{"tabs__item--active":a===t}),children:n??t},t)}))})}function v(e){let{lazy:t,children:n,selectedValue:r}=e;const s=(Array.isArray(n)?n:[n]).filter(Boolean);if(t){const e=s.find((e=>e.props.value===r));return e?(0,a.cloneElement)(e,{className:"margin-top--md"}):null}return(0,x.jsx)("div",{className:"margin-top--md",children:s.map(((e,t)=>(0,a.cloneElement)(e,{key:t,hidden:e.props.value!==r})))})}function w(e){const t=f(e);return(0,x.jsxs)("div",{className:(0,r.A)("tabs-container",g.tabList),children:[(0,x.jsx)(y,{...e,...t}),(0,x.jsx)(v,{...e,...t})]})}function j(e){const t=(0,b.A)();return(0,x.jsx)(w,{...e,children:d(e.children)},String(t))}},8453:(e,t,n)=>{n.d(t,{R:()=>o,x:()=>l});var a=n(6540);const r={},s=a.createContext(r);function o(e){const t=a.useContext(s);return a.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function l(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:o(e.components),a.createElement(s.Provider,{value:t},e.children)}}}]);